# hostmain
공부했던 내용들 정리할 예정


# 트랜잭션의 개념

인가 받지 않은 사용자로부터 데이터를 보장하기 위해 DBMS가 가져야 하는 특성이자, 데이터베이스 시스템에서 하나의 논리적 기능을 정상적으로 수행하는 기본 단위.

## 트랜잭션의 특성
- 원자성(Atomicity) : 트랜잭션을 구성하는 연산 전체가 모두 정상적으로 실행되거나 일부만 실행되어도 실패로 관주되는 것(Commit/Rollback 회복성보장)
- 일관성(Consistency) : 시스템이 가지고 있는 고정요소는 트랜잭션 수행 전과 수행 후의 상태가 동일해야 한다.
- 격리성(isolation) : 동시에 실행되는 트랜잭션들이 서로 영향을 미치지 않아야 한다는 성질.
- Read Uncommited, Read Committed, Repeatable Read, Serializable 등이 대표적임
- 영속성(Durability) : 성공이 완료된 트랜잭션의 결과는 영속적으로 데이터베이스에 저장되어야 하는 성질( 회복기법이 대표적)


## 트랜잭션의 상태
- 활동상태(Active) : 초기 상태, 트랜잭션이 실행 중일 때 가지는 상태
- 부분 완료 상태(Partially Committed) : 마지막 명령문이 실행된 후에 가지는 상태
- 완료 상태(Committed) : 트랜잭션이 성공적으로 완료된 후에 가지는 상태
- 실패 상태(Failed) : 정상적인 실행이 더 이상 진행될 수 없을 떄 가지는 상태
- 철회 상태(Aborted) : 트랜잭션이 취소되고 데이터베이스가 트랜잭션 시작 전으로 되돌아간 상태.

## 트랜잭션 제어
- 트랜잭션 제어언어는 TCL(Transaction Control Language). 트랜잭션의 결과를 허용하거나 취소하는 목적으로 사용되는 언어를 말한다.
- 대표적인 명령어로는 커밋(commit), 롤백(ROLLBACK), 체크포인트(CHECKPOINT)가 존재한다.
- 커밋은 트랜잭션 확정(부분 완료에서 완료), 롤벡은 트랜젝션의 취소(실패에서 철회로), 체크포인트는 저장시기 설정에 목적이 있다.
- 커밋은 트랜잭션을 메모리에 영구적으로 저장하는 명령어
- 롤백은 트랜잭션 내역을 저장 무효화시키는 명령어
- 체크포인트는 ROLLBACK을 위한 시점을 지정하는 명령어임.

## 병행제어(Concurrency Control) 개념
- 다수 사용자 환경에서 여러 트랜젝션을 수행할 때, 데이터베이스의 일관성 유지를 목적으로 상호 작용을 조절하는 걸 말한다.

### 병행제어의 목적
- 데이터베이스의 공유를 최소화
- 시스템의 활용도를 최대화
- 데이터베이스 일관성을 유지
- 사용자에 대한 응답시간을 최소화 시킴

### 병행제어 미보장시 문제점
- 갱신 손실(Lost UPDATE) : 먼저 실행된 결과를 나중에 실행된 녀석이 덮어쓸 떄, 발생되는 오류
- 현황 파악오류(Dirty Read) : 트랜잭션의 중간 수행 결과를 다른 트랜잭션이 참조할 때 발생되는 오류
- 모순성(inconsistency) : 두 트랜잭션이 동시에 실행되어 데이터베이스의 일관성이 결여되는 경우
- 연쇄복귀(Cascading RollBack) :  복수의 트랜잭션이 데이터 공유 시 특정 트랜잭션이 처리를 취소할 경우, 트랜잭션이 처리한 곳의 부분을 취소하지 못하는 오류

### 병행제어 기법
- 로킹(Locking) : 같은 자원을 액세스하는 동안, 다중 트랙젝션 환경에서 DB의 일관성과 무결성을 유지하기 위해 트랜잭션의 순차적 진행을 보장하는 기법
- 낙관적 검증(Optimistic Validation) : 트랜잭션이 어떠한 검증도 수행하지 않고 일단 트랜잭션을 수행하고, 트랜잭션 종료시 검증을 수행하여 데이터베이스에 반영하는 기법
- 타임스탬프 순서(Time Stamp ordering) : 트랜잭션들을 읽거나 갱신한 데이터에 대해 트랜잭션이 실행 하기 전에 타임 스탬프를 부여하여, 부여된 시간 순서에 따라 작업하는 기법
- 다중 버전 동시성 제어(MVCC : Mutli Version Concurrency Control) : 트랜잭션의 타임스탬프와 접근하려는 데이터의 타임 스탬프를 비교하여 직렬가능성이 보장되는 적절한 버전을
선택하여 접근하도록하는 기법

#### 로킹의 특징
- 데이터베이스, 파일, 레코드 등은 로킹의 단위가 될 수 있음
- 로킹 단위가 작아지면 데이터베이스 공유도가 증가
- 로킹 단위가 작아지면 로킹 오버헤드가 증가
- 한꺼번에 로킹할 수 있는 객체의 크기를 로킹 단위라고 함

### 격리성 주요기법

#### 고립화 수준 개념
- 고립화수준은 다른 트랜잭션이 현재의 데이터에 대한 무결성을 위해 잠금을 해재하는 정도다.

#### 고립화 수준 정도
- Read UnCommitted : 한 트랜잭션에서 연산 중인 데이터를 다른 트랜잭션이 읽는 것을 허용함 단, 연산 중인 데이터에 대한 재연산은 불허
- Read Committed : 연산이 완료될 때까지 연산 대상 데이터에 대한 읽기를 제한함. 단, 연산이 완료된 녀석은 다른 트랜젝션이 읽는 걸 허용
- Repeatable Read : 트랜잭션 종료시까지 해당 데이터에 대한 갱신, 삭제를 제한
- Serializable Read : 순차적으로 데이터를 읽을 때, 해당 데이터 영역 전체에 대한 접근을 제한.


### 회복 기법 개념
- 트랜잭션 수행 도중 장애가 발생하였을 경우, 손상된 데이터베이스를 원래 상태로 복구하는 작업

### 회복 기법의 종류
#### -로그 기반 회복 기법
- 지연갱신 회복 기법 : 트랜잭션이 완료되기 전까지 데이터베이스에 기록하지 않음
- 즉각 갱신 회복 기법 : 트랜잭션 수행 중 갱신 결과를 즉각 DB에 반영하는 기법

#### -체크포인트 회복 기법
- 장애 발생시 검사점 이후에 처리된 트랜잭션에 대해서만 장해 발생 이전 상태로 복구

#### - 그림자 페이징 회복 기법
- 데이터베이스 트랜잭션 수행 시 복제본을 생성하여 데이터베이스 장애시 이를 이용해 복원(그러니까, 이전 상태를 따로 뺴두는 개념)






